


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > ModalDrawerImplKt</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">team.duckie.quackquack.ui.component.internal</a>
</div>

<h1>Coverage Summary for Class: ModalDrawerImplKt (team.duckie.quackquack.ui.component.internal)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
<th class="coverageStat 
">
  Instruction, %
</th>
</tr>
<tr>
  <td class="name">ModalDrawerImplKt</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/68)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/418)
  </span>
</td>
</tr>
  <tr>
    <td class="name">ModalDrawerImplKt$QuackModalDrawerImpl$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/16)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/42)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/304)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$QuackModalDrawerImpl$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$QuackModalDrawerImpl$1$2$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/26)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$QuackModalDrawerImpl$1$2$2$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/16)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$QuackModalDrawerImpl$1$2$3$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/12)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$QuackModalDrawerImpl$1$2$4$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/10)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$QuackModalDrawerImpl$1$2$4$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$QuackModalDrawerImpl$1$2$5</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/45)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$QuackModalDrawerImpl$2</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$Scrim$1$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/26)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$Scrim$1$1$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$Scrim$2$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/16)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">ModalDrawerImplKt$Scrim$3</td>
    <td class="coverageStat"/>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/15)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/96)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/90)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/882)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * Designed and developed by 2022 SungbinLand, Team Duckie
&nbsp; *
&nbsp; * Licensed under the MIT.
&nbsp; * Please see full license: https://github.com/duckie-team/quack-quack-android/blob/master/LICENSE
&nbsp; */
&nbsp;
&nbsp;package team.duckie.quackquack.ui.component.internal
&nbsp;
&nbsp;import androidx.compose.foundation.Canvas
&nbsp;import androidx.compose.foundation.gestures.Orientation
&nbsp;import androidx.compose.foundation.gestures.detectTapGestures
&nbsp;import androidx.compose.foundation.layout.Box
&nbsp;import androidx.compose.foundation.layout.BoxWithConstraints
&nbsp;import androidx.compose.foundation.layout.Column
&nbsp;import androidx.compose.foundation.layout.ColumnScope
&nbsp;import androidx.compose.foundation.layout.fillMaxSize
&nbsp;import androidx.compose.foundation.layout.offset
&nbsp;import androidx.compose.foundation.layout.padding
&nbsp;import androidx.compose.foundation.layout.sizeIn
&nbsp;import androidx.compose.material.ExperimentalMaterialApi
&nbsp;import androidx.compose.material.FractionalThreshold
&nbsp;import androidx.compose.material.swipeable
&nbsp;import androidx.compose.runtime.Composable
&nbsp;import androidx.compose.runtime.rememberCoroutineScope
&nbsp;import androidx.compose.ui.Modifier
&nbsp;import androidx.compose.ui.graphics.Color
&nbsp;import androidx.compose.ui.input.pointer.pointerInput
&nbsp;import androidx.compose.ui.platform.LocalDensity
&nbsp;import androidx.compose.ui.unit.IntOffset
&nbsp;import androidx.compose.ui.unit.dp
&nbsp;import kotlin.math.roundToInt
&nbsp;import kotlinx.coroutines.launch
&nbsp;import team.duckie.quackquack.ui.color.QuackColor
&nbsp;import team.duckie.quackquack.ui.component.QuackDrawerState
&nbsp;import team.duckie.quackquack.ui.component.QuackDrawerValue
&nbsp;import team.duckie.quackquack.ui.component.QuackSurface
&nbsp;import team.duckie.quackquack.ui.modifier.quackClickable
&nbsp;import team.duckie.quackquack.ui.util.runIf
&nbsp;
<b class="nc">&nbsp;private val QuackDrawerVelocityThreshold = 400.dp</b>
<b class="nc">&nbsp;private val QuackEndDrawerPadding = 76.dp</b>
&nbsp;
&nbsp;private const val QuackThresholdFraction = 0.5f
&nbsp;
&nbsp;private const val QuackDrawerExceptionMessage = &quot;Drawer shouldn&#39;t have infinite width&quot;
&nbsp;
&nbsp;/**
&nbsp; * QuackModalDrawer 의 구현체 입니다.
&nbsp; *
&nbsp; * QuackModalDrawer 가 open 상태가 아닐 때 원래 content 를
&nbsp; * 인식하기 위해 [content] 를 인수로 받습니다.
&nbsp; *
&nbsp; * @param drawerState Drawer 의 상태 [QuackDrawerState]
&nbsp; * @param gesturesEnabled drag gesture 의 허용 여부
&nbsp; * @param drawerContent Drawer 내부에 들어갈 content
&nbsp; * @param content Drawer 가 Close 일 때 표시 할 컴포저블
&nbsp; */
&nbsp;@ExperimentalMaterialApi
&nbsp;@Composable
&nbsp;internal fun QuackModalDrawerImpl(
&nbsp;    drawerState: QuackDrawerState,
<b class="nc">&nbsp;    gesturesEnabled: Boolean = true,</b>
&nbsp;    drawerContent: @Composable ColumnScope.() -&gt; Unit,
&nbsp;    content: @Composable () -&gt; Unit,
<b class="nc">&nbsp;) {</b>
<b class="nc">&nbsp;    val scope = rememberCoroutineScope()</b>
&nbsp;
<b class="nc">&nbsp;    BoxWithConstraints(</b>
<b class="nc">&nbsp;        modifier = Modifier.fillMaxSize(),</b>
<b class="nc">&nbsp;    ) {</b>
<b class="nc">&nbsp;        val modalDrawerConstraints = constraints</b>
<b class="nc">&nbsp;        if (!modalDrawerConstraints.hasBoundedWidth) {</b>
<b class="nc">&nbsp;            throw IllegalStateException(</b>
<b class="nc">&nbsp;                QuackDrawerExceptionMessage</b>
&nbsp;            )
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        val minValue = -modalDrawerConstraints.maxWidth.toFloat()</b>
<b class="nc">&nbsp;        val maxValue = 0f</b>
&nbsp;
<b class="nc">&nbsp;        val anchors = mapOf(</b>
<b class="nc">&nbsp;            minValue to QuackDrawerValue.Closed,</b>
<b class="nc">&nbsp;            maxValue to QuackDrawerValue.Open,</b>
&nbsp;        )
&nbsp;
<b class="nc">&nbsp;        Box(</b>
<b class="nc">&nbsp;            modifier = Modifier.swipeable(</b>
<b class="nc">&nbsp;                state = drawerState.swipeableState,</b>
<b class="nc">&nbsp;                anchors = anchors,</b>
&nbsp;                thresholds = { _, _ -&gt;
<b class="nc">&nbsp;                    FractionalThreshold(</b>
<b class="nc">&nbsp;                        fraction = QuackThresholdFraction,</b>
&nbsp;                    )
&nbsp;                },
<b class="nc">&nbsp;                orientation = Orientation.Horizontal,</b>
<b class="nc">&nbsp;                enabled = gesturesEnabled,</b>
<b class="nc">&nbsp;                velocityThreshold = QuackDrawerVelocityThreshold,</b>
<b class="nc">&nbsp;                resistance = null,</b>
&nbsp;            ),
&nbsp;        ) {
<b class="nc">&nbsp;            Box {</b>
<b class="nc">&nbsp;                content()</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;            Scrim(</b>
<b class="nc">&nbsp;                open = drawerState.isOpen,</b>
&nbsp;                onClose = {
<b class="nc">&nbsp;                    if (</b>
<b class="nc">&nbsp;                        gesturesEnabled &amp;&amp;</b>
<b class="nc">&nbsp;                        drawerState.confirmStateChange(QuackDrawerValue.Closed)</b>
&nbsp;                    ) {
<b class="nc">&nbsp;                        scope.launch {</b>
<b class="nc">&nbsp;                            drawerState.close()</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                },
<b class="nc">&nbsp;                fraction = {</b>
<b class="nc">&nbsp;                    calculateFraction(</b>
<b class="nc">&nbsp;                        a = minValue,</b>
<b class="nc">&nbsp;                        b = maxValue,</b>
<b class="nc">&nbsp;                        pos = drawerState.offset.value</b>
&nbsp;                    )
&nbsp;                },
<b class="nc">&nbsp;                color = QuackColor.BlackOpacity60.composeColor,</b>
&nbsp;            )
<b class="nc">&nbsp;            QuackSurface(</b>
<b class="nc">&nbsp;                modifier = with(</b>
<b class="nc">&nbsp;                    receiver = LocalDensity.current,</b>
&nbsp;                ) {
<b class="nc">&nbsp;                    Modifier</b>
<b class="nc">&nbsp;                        .sizeIn(</b>
<b class="nc">&nbsp;                            minWidth = modalDrawerConstraints.minWidth.toDp(),</b>
<b class="nc">&nbsp;                            minHeight = modalDrawerConstraints.minHeight.toDp(),</b>
<b class="nc">&nbsp;                            maxWidth = modalDrawerConstraints.maxWidth.toDp(),</b>
<b class="nc">&nbsp;                            maxHeight = modalDrawerConstraints.maxHeight.toDp()</b>
&nbsp;                        )
<b class="nc">&nbsp;                        .offset {</b>
<b class="nc">&nbsp;                            IntOffset(</b>
<b class="nc">&nbsp;                                x = drawerState.offset.value.roundToInt(),</b>
<b class="nc">&nbsp;                                y = 0,</b>
&nbsp;                            )
&nbsp;                        }
<b class="nc">&nbsp;                        .padding(</b>
<b class="nc">&nbsp;                            end = QuackEndDrawerPadding,</b>
&nbsp;                        )
<b class="nc">&nbsp;                        .quackClickable(</b>
<b class="nc">&nbsp;                            rippleEnabled = false,</b>
<b class="nc">&nbsp;                            onClick = {},</b>
&nbsp;                        )
&nbsp;                },
<b class="nc">&nbsp;                backgroundColor = QuackColor.White,</b>
<b class="nc">&nbsp;            ) {</b>
<b class="nc">&nbsp;                Column(</b>
<b class="nc">&nbsp;                    modifier = Modifier.fillMaxSize(),</b>
<b class="nc">&nbsp;                    content = drawerContent,</b>
<b class="nc">&nbsp;                )</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;        }</b>
&nbsp;    }
<b class="nc">&nbsp;}</b>
&nbsp;
&nbsp;/**
&nbsp; * QuackModalDrawer 외부에 표시 될 배경 오버레이
&nbsp; *
&nbsp; * @param open Drawer 가 open 되었는지 여부
&nbsp; * @param onClose Drawer 외부를 터치 했을 때의 닫힘 이벤트
&nbsp; * @param fraction 배경에 적용 될 명암 정도
&nbsp; * @param color 배경에 적용 될 색상
&nbsp; */
&nbsp;@Composable
&nbsp;private fun Scrim(
&nbsp;    open: Boolean,
&nbsp;    onClose: () -&gt; Unit,
&nbsp;    fraction: () -&gt; Float,
&nbsp;    color: Color,
<b class="nc">&nbsp;) {</b>
<b class="nc">&nbsp;    Canvas(</b>
<b class="nc">&nbsp;        modifier = Modifier</b>
<b class="nc">&nbsp;            .fillMaxSize()</b>
<b class="nc">&nbsp;            .runIf(</b>
&nbsp;                condition = open,
&nbsp;            ) {
<b class="nc">&nbsp;                pointerInput(</b>
<b class="nc">&nbsp;                    key1 = onClose,</b>
<b class="nc">&nbsp;                ) {</b>
<b class="nc">&nbsp;                    detectTapGestures {</b>
<b class="nc">&nbsp;                        onClose()</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            },
<b class="nc">&nbsp;    ) {</b>
<b class="nc">&nbsp;        drawRect(</b>
<b class="nc">&nbsp;            color = color,</b>
<b class="nc">&nbsp;            alpha = fraction(),</b>
&nbsp;        )
&nbsp;    }
<b class="nc">&nbsp;}</b>
&nbsp;
&nbsp;/**
&nbsp; * 화면의 어느 포인트에 위치하고 있는지에 대한 Fraction
&nbsp; * Drawer 가 열려 있는 정도에 따라 큰 값을 반환합니다.
&nbsp; *
&nbsp; * @param a 최소 값
&nbsp; * @param b 최대 값
&nbsp; * @param pos 현재 Drawer 가 위치한 offset
&nbsp; * @return Drawer 가 열려있는 정도
&nbsp; */
&nbsp;@Suppress(&quot;SameParameterValue&quot;)
&nbsp;private fun calculateFraction(
&nbsp;    a: Float,
&nbsp;    b: Float,
&nbsp;    pos: Float,
<b class="nc">&nbsp;) = ((pos - a) / (b - a)).coerceIn(</b>
<b class="nc">&nbsp;    minimumValue = 0f,</b>
<b class="nc">&nbsp;    maximumValue = 1f,</b>
&nbsp;)
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2022-11-09 11:41</div>
</div>
</body>
</html>
